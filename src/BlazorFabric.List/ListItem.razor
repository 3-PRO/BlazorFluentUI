@using BlazorFabric.BaseComponent

@inherits FabricComponentBase

@using Microsoft.JSInterop

@inject IJSRuntime JSRuntime

<div @ref="RootElementReference" @ref:suppressField
     role="listitem"
     class=@($"ms-List-cell fabricList-item {(IsActive ? "is-active" : "")}")
     @onclick="@(e=>OnItemClick(e))">
    @ChildContent
</div>

@functions{
    public double Width { get; set; }
    public double Height { get; set; }

    [Parameter] public object Item { get; set; }

    [Parameter] public bool IsActive { get; set; }

    [Parameter] public int IndexPosition { get; set; }

    [Parameter] public RenderFragment ChildContent { get; set; }

    [Parameter]
    public Func<object, UIMouseEventArgs, Task> ItemClicked { get; set; }

    protected override async Task OnAfterRenderAsync()
    {
        //var result = await JSRuntime.InvokeAsync<Dictionary<string, double>>("BlazorFabricList.measureElement", rootElement);
        //this.Width = result["width"];
        //this.Height = result["height"];
        await base.OnAfterRenderAsync();
    }

    private Task OnItemClick(UIMouseEventArgs e)
    {

        return ItemClicked.Invoke(this.Item, e);
    }
}